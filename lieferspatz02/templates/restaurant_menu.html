{% extends "base.html" %}
{% block title %}Menu{% endblock %}
{% block button %}
    <a href="/home" class="button-link">Home</a>
    <a href="{{url_for('order_cart.view_cart')}}" class="button-link">Cart</a>
    <form action="/logout_customer" method="POST">
        <input type="submit" value="Logout" class="button-link">
    </form>
{% endblock %}
{% block content %}
    {% with messages = get_flashed_messages() %}
        {% if messages %}
            {% for msg in messages %}
                <p>{{ msg }}</p>
            {% endfor %}
        {% endif %}
    {% endwith %}
    <h1>Welcome to the Menu of {{ restaurants[2] }} {{ customer_id }}</h1>

    <h2>Description: {{ restaurants[5] }}</h2>

    <h2>Restaurant Name: {{ restaurants[2] }}</h2>
    <p>Address: {{ restaurants[3] }}, {{ restaurants[4] }}</p>

    {% if menus %}
        <h3>Menu</h3>
        {% for menu in menus %}
            <div class="menu-item">
                <div class="bordered-box">
                    <h4>{{ menu[2] }}</h4>
                    <p>Price: {{ menu[4] }}</p>
                    <p>Detail: {{ menu[3] }}</p>
                    <p>Type: {{ menu[5] }}</p>
                </div>
                <div class="add-to-cart-button">
                    <form class="add-to-cart-form">
                        <input type="hidden" name="item_id" value="{{ menu[0] }}">
                        <input type="hidden" name="restaurant_id" value="{{ restaurants[0] }}">
                        <input type="hidden" name="customer_id" value="{{ customer_id }}">
                        <input type="hidden" name="price" value="{{ menu[2] }}">
                        <input type="hidden" name="restaurant_name" value="{{ restaurants[1] }}">
                        <input type="hidden" name="item_name" value="{{ menu[1] }}">
                        <input type="button" value="Add to Cart" class="button add-to-cart-btn">
                    </form>
                </div>
                <div style="clear:both;"></div> <!-- Clear the float -->
            </div>
        {% endfor %}
        
    {% else %}
        <p>No menu items available.</p>
    {% endif %}
</body>

<script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>

<script>
    $(document).ready(function () {
        $(".add-to-cart-btn").click(function () {
            var form = $(this).closest(".add-to-cart-form");

            // Serialize the form data
            var formData = form.serialize();

            // AJAX request to add item to the cart
            $.ajax({
                url: "/order_cart/add_to_cart",
                type: "POST",
                data: formData,
                success: function (response) {
                    // Handle success, if needed
                    alert(response.message); // Display a message or perform other actions
                },
                error: function (error) {
                    // Handle error, if needed
                    console.error("Error adding to cart:", error);
                }
            });
        });
    });
</script>

<style>
    /* Updated styles for the bordered box with off-white color */
    .bordered-box {
        border: 2px solid #f8f8f8;
        padding: 10px;
        border-radius: 8px;
        background-color: #f8f8f8; /* Background color for better visibility */
        margin-bottom: 10px;
        float: left;
    }

    /* Styles for the Add to Cart button */
    .add-to-cart-button {
        float: right;
        margin-top: 10px;
    }

    /* Clear float for proper alignment */
    .menu-item {
        overflow: auto;
    }

    /* Basic button styles */
    .button {
        background-color: #4CAF50;
        color: white;
        padding: 10px;
        text-align: center;
        text-decoration: none;
        display: inline-block;
        font-size: 14px;
        cursor: pointer;
        border-radius: 5px;
    }
</style>

</html>
{% endblock %}

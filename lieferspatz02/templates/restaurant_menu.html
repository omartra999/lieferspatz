{% extends "base.html" %}
{% block title %}Menu{% endblock %}
{% block button %}
    <a href="/home" class="button-link">Home</a>
    <a href="{{url_for('order_cart.view_cart')}}" class="button-link">Cart</a>
    <form action="/logout_customer" method="POST">
        <input type="submit" value="Logout" class="button-link">
    </form>
{% endblock %}
{% block content %}

    {% with messages = get_flashed_messages() %}
        {% if messages %}
            {% for msg in messages %}
                <p>{{ msg }}</p>
            {% endfor %}
        {% endif %}
    {% endwith %}
    <h1>Welcome to the Menu of {{ restaurants[2] }} {{ customer_id }}</h1>

    <h2>Description: {{ restaurants[7] }}</h2>

    <h2>Restaurant Name: {{ restaurants[2] }}</h2>
    <p>Address: {{ restaurants[3] }}, {{ restaurants[4] }}</p>

        {% if menus %}
            <h3>Menu</h3>
            <div class="menu-container">
                {% for menu in menus %}
                    <div class="menu-item">
                        <div class="info-container">
                            <h4>{{ menu['menu'][1] }}</h4>
                            <p>Price: {{ menu['menu'][3] }}</p>
                            <p>Detail: {{ menu['menu'][2] }}</p>
                            <p>Type: {{ menu['menu'][4] }}</p>
                        </div>
                        <div class="image-container">
                            <img class="restaurant-menu-logo-img" src="data:image/*;base64,{{ menu['logo'] }}" alt="food Logo">
                        </div>
                        <div class="add-to-cart-button">
                            <form class="add-to-cart-form">
                                <input type="hidden" name="item_id" value="{{ menu['menu'][0] }}">
                                <input type="hidden" name="restaurant_id" value="{{ restaurants[0] }}">
                                <input type="hidden" name="customer_id" value="{{ customer_id }}">
                                <input type="hidden" name="price" value="{{ menu['menu'][3] }}">
                                <input type="hidden" name="restaurant_name" value="{{ restaurants[1] }}">
                                <input type="hidden" name="item_name" value="{{ menu['menu'][1] }}">
                                <input type="button" value="Add to Cart" class="button add-to-cart-btn">
                            </form>
                        </div>
                        <div style="clear:both;"></div> <!-- Clear the float -->
                    </div>
                {% endfor %}
            </div>
        {% else %}
            <p>No menu items available.</p>
        {% endif %}
        
   
</body>

<script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>

<script>
    $(document).ready(function () {
        $(".add-to-cart-btn").click(function () {
            var form = $(this).closest(".add-to-cart-form");

            // Serialize the form data
            var formData = form.serialize();

            // AJAX request to add item to the cart
            $.ajax({
                url: "/order_cart/add_to_cart",
                type: "POST",
                data: formData,
                success: function (response) {
                    // Handle success, if needed
                    alert(response.message); // Display a message or perform other actions
                },
                error: function (error) {
                    // Handle error, if needed
                    console.error("Error adding to cart:", error);
                }
            });
        });
    });
</script>

</html>
{% endblock %}
